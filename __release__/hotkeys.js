var hokInit=function(){function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,t=function(){};return{s:t,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw r}}}}function a(e){console.clear();var t=l(e.undo);try{for(t.s();!(n=t.n()).done;){var n=n.value;console.log(n)}}catch(e){t.e(e)}finally{t.f()}document.querySelector(".log__redo").innerHTML="";var a=l(e.redo);try{for(a.s();!(i=a.n()).done;){var r=i.value,i=document.createElement("p");i.innerText=JSON.stringify(r),document.querySelector(".log__redo").appendChild(i)}}catch(e){a.e(e)}finally{a.f()}}var i=document.getElementById("editor")||document.querySelector("textarea"),r=[],s=[],c=!1;i.addEventListener("keydown",function(e){u.selection={start:e.target.selectionStart,end:e.target.selectionEnd},u.selection_length?u.lostData=i.value.slice(u.selection.start,u.selection.end):u.lostData=i.value.slice(u.selection.start-1,u.selection.end+1)}),i.addEventListener("paste",function(e){u.data=(window.clipboardData||e.clipboardData).getData("text/plain"),u.data=u.data.replace(/\r\n/g,"\n")}),i.addEventListener("input",function(e){return"historyUndo"==e.inputType?(console.log(e.inputType),e.preventDefault(),!1):(u.type=e.inputType,u.type!==g.insertFromPaste&&(u.data=e.data),u.selection_length?u.selection.end=u.selection.start:u.type==g.deleteContentBackward?(u.selection.start--,u.selection.end--,u.lostData=u.lostData[0]):u.type==g.deleteContentForward?u.lostData=u.lostData[1]:u.type!=g.insertText&&u.type!=g.insertFromPaste||(u.lostData=u.lostData.slice(1,-1)),r.push(Object.assign({},u)),"historyUndo"!=e.inputType&&s.splice(0,s.length),void(c&&a(f)))});var u={type:null,data:null,lostData:null,get selection_length(){return this.selection.end-this.selection.start},selection:{start:null,end:null}};function d(e,t){var n,a;switch(Boolean(t)!==Boolean("redo")?(a=e.lostData,n=e.data):(n=e.lostData,a=e.data),e.type){case"insertFromPaste":i.value=i.value.substring(0,e.selection.start)+a+i.value.substring(e.selection.start+n.length),i.setSelectionRange(e.selection.start,e.selection.end+a.length),e.caret&&(i.selectionStart=i.selectionEnd);break;case"insertText":e.selection_length||(i.value=i.value.substring(0,e.selection.start)+(a||"")+i.value.substring(e.selection.start+(n||"").length)),i.setSelectionRange(e.selection.start+a.length,e.selection.end+a.length);break;case"deleteByCut":case"deleteContentForward":case"deleteContentBackward":i.value=i.value.substring(0,e.selection.start)+(a||"")+i.value.substring(e.selection.end+!!t*(n||"").length),i.selectionStart=i.selectionEnd=e.selection.start+(e.type==g.deleteContentBackward&&1==(a||"").length),1<(a||"").length&&(i.selectionEnd=e.selection.start+a.length)}}var v=function(e,t,n,a){e.target.dispatchEvent(new KeyboardEvent("keydown"));var r=t(e),t=new DataTransfer;t.setData("text/plain",e.target.value.slice((a||e.target).selectionStart,e.target.selectionEnd));t=new ClipboardEvent("paste",{clipboardData:t});e.target.dispatchEvent(t),e.target.dispatchEvent(new InputEvent("input",{data:null,inputType:"insertFromPaste"})),n&&r&&void 0!==r.backoffset&&n(r)},p=function(e,t,n){e.target.selectionStart=n.startLine+1,e.target.selectionEnd=n.endLine,e.target.dispatchEvent(new KeyboardEvent("keydown",{}));var a=t(e),t=new DataTransfer;t.setData("text/plain",e.target.value.substr(n.startLine+1,a.line.length));t=new ClipboardEvent("paste",{clipboardData:t});return e.target.dispatchEvent(t),u.caret=123,e.target.dispatchEvent(new InputEvent("input",{data:null,inputType:"insertFromPaste"})),u.caret=void 0,a},g={insertFromPaste:"insertFromPaste",deleteByCut:"deleteByCut",insertText:"insertText",deleteContentBackward:"deleteContentBackward",deleteContentForward:"deleteContentForward"},f={undo:r,redo:s},e=function(e){if(e.shiftKey)return n=e,void((t=s.pop())&&(r.push(t),c&&a(f),d(t,"redo"),n.preventDefault&&n.preventDefault()));var t,n=r.pop();n&&(s.push(n),c&&a(f),d(n,""),e.preventDefault&&e.preventDefault())},y={paste:null},h=Object.freeze({Begin:0,preBegin:1,fillInside:2,Fill:3,preEnd:4,End:5}),t={begin:function(e,t,n){var a,r=n.selectionStart,i=n.selectionEnd,l=n.value.substring(r-1,i),o=(l.split("\n").length-1)*e.length,s=l.startsWith("\n"+e);0==o?format_text(t):(a=n.value.substring(0,r-1),l=s?l.replace(new RegExp("\n"+e,"g"),"\n"):l.replace(new RegExp("\n","g"),"\n"+e),n.value=[a,l,n.value.substring(i)].join(""),n.selectionStart=r,n.selectionEnd=i+o*(s?-1:1)),t.preventDefault()},begin_end:function(e,t,n){var a,r,i=n.selectionStart,l=n.selectionEnd,o=n.value.substring(i,l);return 1===o.split("\n").length?format_text(t):(a=n.value.substring(0,i),o=e[0]+n.value.substring(i,l)+e[1],r=n.value.substring(l),n.value=[a,o,r].join(""),n.setSelectionRange(i,l+e[0].length+e[1].length)),t.preventDefault(),{backoffset:void 0}},paste_inline:function(a,e,r,i,l){var o=r.selectionStart,s=r.selectionEnd,c=r.value.substring(o,s);0<c.indexOf("\n")||(y.paste=function(e,t){var n;l(t)&&(n=r.value.substring(0,o),c=a.replace("%1",c).replace("$1",t),t=r.value.substring(s),r.value=[n,c,t].join(""),r.selectionEnd=(r.selectionStart=o)+c.length,e.preventDefault(),y.paste=null,(t=new DataTransfer).setData("text/plain",c),e.target.dispatchEvent(new ClipboardEvent("paste",{clipboardData:t})),r.dispatchEvent(new InputEvent("input",{data:null,inputType:"insertFromPaste"})),i===h.End&&(r.selectionStart=r.selectionEnd=o+c.length))})}},b=null,E={},w={};function n(e,t,n){var a,r;if(a=b=e||document.querySelector("textarea"),c=r,i=a,!(e instanceof HTMLTextAreaElement))throw new Error("editor with hot keys needs textarea on the page");b.addEventListener("keydown",m),t instanceof Object&&("actions"in t&&t.actions instanceof Object&&(w=t.actions),"multiActions"in t&&t.multiActions instanceof Object&&(E=t.multiActions)),n instanceof HTMLElement&&(n=[].slice.apply(n.querySelectorAll(".".concat(n.className,">*")))),Array.isArray(n)&&n.forEach(function(e){return e.addEventListener("click",D)}),b.addEventListener("paste",function(e){e.isTrusted&&(y.paste||function(){})(e,e.clipboardData.getData("text/plain"))}),b.addEventListener("select",function(e){})}function m(n){var a,r,i,l;n.ctrlKey?("KeyZ"!=n.code?D:e)(n):"tab"===n.key.toLowerCase()&&(a=n.target.selectionStart,0<(r=n.target.selectionEnd)-a?(i=n.target.value.substring(a-1,r),0==(l=i.split("\n").length-1)?D(n):v(n,function(){var e=n.target.value.substring(0,a-1);i=n.shiftKey?i.replace(/\n	/g,"\n"):i.replace(/\n/g,"\n\t");var t=n.target.value.substring(r);n.target.value=[e,i,t].join(""),n.target.selectionStart=a,n.target.selectionEnd=r+l*(n.shiftKey?-1:1)}),n.preventDefault()):D(n))}function D(t,e){var n=0;if(e=e||t.target.getAttribute("data-key"),void 0!==b.selectionStart){if(b.selectionStart<b.selectionEnd)if(1<b.value.slice(b.selectionStart,b.selectionEnd).split("\n").length){if(t.key=t.key||t.target.getAttribute("data-key"),E[t.key]||E[t.code])return v(t,function(){return(E[t.key]||E[t.code])(t)})}else"KeyV"===t.code&&(E[t.key]||E[t.code])&&(b.selectionEnd-=" "===b.value[b.selectionEnd-1],t.target.dispatchEvent(new KeyboardEvent("keydown")),(E[t.key]||E[t.code])(t));n=b.selectionStart}else alert("The browser not supports hot keys");var a=b.value.lastIndexOf("\n",n-1),r=b.value.indexOf("\n",n);r<0&&(r=b.value.length);var i=b.value.substr(0,a&&a+1),l=b.value.substring(a&&a+1,r),o=b.value.substr(r),s=w[t&&(t.key||e)];t.key||(t={target:b}),s&&((r=p(t,function(){var e=s(l,t);return b.value=i+e.line+o,e},{startLine:a,endLine:r})).eventAbort&&t.preventDefault(),b.selectionStart=b.selectionEnd=n+r.offset*(r.undo?-1:1),b.focus())}return n.actionsMacro={tag_in:function(e,t){t=this.begin_end(["<"+e+">","</"+e+">"],t);return t.offset+=t.offset+1,t},begin_end:function(e,t){var n=e[0],a=e[1],r=new RegExp(n+"([\\s\\S]*?)"+a),e=t.match(r);return{line:e?t.replace(r,"$1"):n+t+a,offset:n.length,undo:e}},begin:function(e,t,n){var a=new RegExp("^"+e+"([\\s\\S]+?)$"),n=n?n.shiftKey:a.exec(t);return{line:n?t.replace(a,"$1"):e+t,offset:e.length,undo:n,eventAbort:!0}}},n.multiMacro=t,n.finalPosition=h,n}();
//# sourceMappingURL=hotkeys.js.map
