var actionhandler=function(e){"use strict";function t(e){console.clear();for(let t of e.undo)console.log(t);document.querySelector(".log__redo").innerHTML="";for(let t of e.redo){let e=document.createElement("p");e.innerText=JSON.stringify(t),document.querySelector(".log__redo").appendChild(e)}}var n=document.getElementById("editor")||document.querySelector("textarea"),a=[],l=[],s=!1;n.addEventListener("keydown",(function(e){r.selection={start:e.target.selectionStart,end:e.target.selectionEnd},r.selection_length?r.lostData=n.value.slice(r.selection.start,r.selection.end):r.lostData=n.value.slice(r.selection.start-1,r.selection.end+1)})),n.addEventListener("paste",(e=>{r.data=(window.clipboardData||e.clipboardData).getData("text/plain"),r.data=r.data.replace(/\r\n/g,"\n")})),n.addEventListener("input",(e=>{if("historyUndo"==e.inputType)return console.log(e.inputType),e.preventDefault(),!1;r.type=e.inputType,r.type!==i.insertFromPaste&&(r.data=e.data),r.selection_length?r.selection.end=r.selection.start:r.type==i.deleteContentBackward?(r.selection.start--,r.selection.end--,r.lostData=r.lostData[0]):r.type==i.deleteContentForward?r.lostData=r.lostData[1]:r.type!=i.insertText&&r.type!=i.insertFromPaste||(r.lostData=r.lostData.slice(1,-1)),a.push(Object.assign({},r)),"historyUndo"!=e.inputType?(l.splice(0,l.length),s&&t(c)):s&&t(c)}));const r={type:null,data:null,lostData:null,get selection_length(){return this.selection.end-this.selection.start},selection:{start:null,end:null}};function o(e,t){if(Boolean(t)!==Boolean("redo"))var a=e.lostData,l=e.data;else l=e.lostData,a=e.data;switch(e.type){case"insertFromPaste":n.value=n.value.substring(0,e.selection.start)+a+n.value.substring(e.selection.start+l.length),n.setSelectionRange(e.selection.start,e.selection.end+a.length),e.caret&&(n.selectionStart=n.selectionEnd);break;case"insertText":e.selection_length||(n.value=n.value.substring(0,e.selection.start)+(a||"")+n.value.substring(e.selection.start+(l||"").length)),n.setSelectionRange(e.selection.start+a.length,e.selection.end+a.length);break;case"deleteByCut":case"deleteContentForward":case"deleteContentBackward":n.value=n.value.substring(0,e.selection.start)+(a||"")+n.value.substring(e.selection.end+!!t*(l||"").length),n.selectionStart=n.selectionEnd=e.selection.start+(e.type==i.deleteContentBackward&&1==(a||"").length),(a||"").length>1&&(n.selectionEnd=e.selection.start+a.length)}}const i={insertFromPaste:"insertFromPaste",deleteByCut:"deleteByCut",insertText:"insertText",deleteContentBackward:"deleteContentBackward",deleteContentForward:"deleteContentForward"};let c={undo:a,redo:l};return e.default=function(e,t){return s=t,n=e},e.input=r,e.storeAction=function(e,t,n){e.target.selectionStart=n.startLine+1,e.target.selectionEnd=n.endLine,e.target.dispatchEvent(new KeyboardEvent("keydown",{}));let a=t(e),l=new DataTransfer;l.setData("text/plain",e.target.value.substr(n.startLine+1,a.line.length));let s=new ClipboardEvent("paste",{clipboardData:l});return e.target.dispatchEvent(s),r.caret=123,e.target.dispatchEvent(new InputEvent("input",{data:null,inputType:"insertFromPaste"})),r.caret=void 0,a},e.storeMultiactions=function(e,t,n,a){e.target.dispatchEvent(new KeyboardEvent("keydown"));let l=t(e),s=new DataTransfer;s.setData("text/plain",e.target.value.slice((a||e.target).selectionStart,e.target.selectionEnd));let r=new ClipboardEvent("paste",{clipboardData:s});e.target.dispatchEvent(r),e.target.dispatchEvent(new InputEvent("input",{data:null,inputType:"insertFromPaste"})),n&&l&&void 0!==l.backoffset&&n(l)},e.undo=e=>{if(e.shiftKey)return(e=>{let n=l.pop();n&&(a.push(n),s&&t(c),o(n,"redo"),e.preventDefault&&e.preventDefault())})(e);let n=a.pop();n&&(l.push(n),s&&t(c),o(n,""),e.preventDefault&&e.preventDefault())},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
